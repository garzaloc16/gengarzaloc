<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadoras MercadoLibre</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { background-color: #f9fafb; }
    .card { background: white; padding: 1.5rem; border-radius: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .result { background: #dcfce7; padding: 1rem; border-radius: 0.5rem; font-weight: bold; text-align: center; }
  </style>
</head>
<body class="flex flex-col items-center p-4 space-y-6">

  <!-- Logo -->
  <img src="https://http2.mlstatic.com/frontend-assets/ui-navigation/5.22.7/mercadolibre/logo__large_plus.png" class="w-28" alt="MercadoLibre">

  <!-- Formulario de Compras -->
  <div class="card max-w-md w-full">
    <h2 class="text-xl font-bold mb-4 text-center">Cálculo de Compras</h2>

    <label>Cantidad de productos</label>
    <input id="cantidad" type="number" class="w-full border p-2 rounded mb-2">

    <label>Costo por unidad (COP)</label>
    <input id="costoUnidad" type="number" class="w-full border p-2 rounded mb-2">

    <label>¿Te cobraron envío?</label>
    <select id="cobroEnvio" class="w-full border p-2 rounded mb-2">
      <option>No</option>
      <option>Sí</option>
    </select>

    <label>Valor del envío (COP)</label>
    <input id="valorEnvio" type="number" class="w-full border p-2 rounded mb-2" value="0">

    <label>¿Te cobraron impuestos?</label>
    <select id="cobroImpuestos" class="w-full border p-2 rounded mb-4">
      <option>No</option>
      <option>Sí</option>
    </select>

    <div id="resultadoCompras" class="result">Costo total: $0</div>
    <div id="resultadoUnidad" class="result mt-2">Costo por unidad final: $0</div>
  </div>

  <!-- Formulario de Ventas -->
  <div class="card max-w-md w-full">
    <h2 class="text-xl font-bold mb-4 text-center">Cálculo de Ventas en MercadoLibre</h2>

    <label>¿Usar costo calculado del formulario 1?</label>
    <select id="usarCosto" class="w-full border p-2 rounded mb-4">
      <option>Sí</option>
      <option>No</option>
    </select>

    <label>Costo base (COP)</label>
    <input id="costoBaseManual" type="number" class="w-full border p-2 rounded mb-4" value="0">

    <label>Categoría</label>
    <select id="categoria" class="w-full border p-2 rounded mb-2">
      <option>Celulares y Teléfonos</option>
      <option>Computación</option>
      <option>Electrodomésticos</option>
      <option>Consolas y Videojuegos</option>
      <option>Accesorios</option>
    </select>

    <label>Tipo de publicación</label>
    <select id="tipoPublicacion" class="w-full border p-2 rounded mb-2">
      <option value="0.13">Premium (13%)</option>
      <option value="0.08">Clásica (8%)</option>
    </select>

    <label>¿Ofrecer envío gratis?</label>
    <select id="envioGratis" class="w-full border p-2 rounded mb-2">
      <option>No</option>
      <option>Sí</option>
    </select>

    <label>Peso del producto (kg)</label>
    <input id="peso" type="number" step="0.1" class="w-full border p-2 rounded mb-4" value="1">

    <hr class="my-4">

    <label>¿Quieres poner tu precio de venta manual?</label>
    <input id="precioVentaManual" type="number" class="w-full border p-2 rounded mb-4" value="0">

    <div id="resultadoVentas" class="result">Calcula el precio sugerido...</div>
  </div>

<script>
function formatoCOP(valor) {
  return valor.toLocaleString('es-CO', { style: 'currency', currency: 'COP' });
}

// --- Variables globales ---
let costoFinalUnidad = 0;

// --- Cálculo Compras ---
function calcularCompras() {
  const cantidad = parseFloat(document.getElementById('cantidad').value) || 0;
  const costoUnidad = parseFloat(document.getElementById('costoUnidad').value) || 0;
  const cobroEnvio = document.getElementById('cobroEnvio').value;
  const valorEnvio = parseFloat(document.getElementById('valorEnvio').value) || 0;
  const cobroImpuestos = document.getElementById('cobroImpuestos').value;

  let total = cantidad * costoUnidad;
  if (cobroEnvio === 'Sí') total += valorEnvio;
  if (cobroImpuestos === 'Sí') total *= 1.19; // 19% IVA

  costoFinalUnidad = cantidad > 0 ? total / cantidad : 0;

  document.getElementById('resultadoCompras').textContent = `Costo total: ${formatoCOP(total)}`;
  document.getElementById('resultadoUnidad').textContent = `Costo por unidad final: ${formatoCOP(costoFinalUnidad)}`;

  calcularVentas(); // recalcula automáticamente el segundo formulario
}

['cantidad','costoUnidad','cobroEnvio','valorEnvio','cobroImpuestos'].forEach(id=>{
  document.getElementById(id).addEventListener('input', calcularCompras);
  document.getElementById(id).addEventListener('change', calcularCompras);
});

// --- Cálculo Ventas ---
function calcularVentas() {
  const usarCosto = document.getElementById('usarCosto').value;
  const comision = parseFloat(document.getElementById('tipoPublicacion').value);
  const envioGratis = document.getElementById('envioGratis').value;
  const peso = parseFloat(document.getElementById('peso').value) || 1;

  let costoBase = usarCosto === 'Sí'
    ? costoFinalUnidad
    : parseFloat(document.getElementById('costoBaseManual').value) || 0;

  // costo envío
  let costoEnvio = 0;
  if (envioGratis === 'Sí') {
    costoEnvio = peso <= 1 ? 7000 : 12000; // ejemplo
  }

  // Precio sugerido mínimo para no perder
  const precioSugerido = (costoBase + costoEnvio) / (1 - comision);

  // Si el usuario pone precio manual, calculamos ganancia
  const precioVentaManual = parseFloat(document.getElementById('precioVentaManual').value) || 0;
  let texto = `Precio sugerido para no perder: ${formatoCOP(precioSugerido)}`;

  if (precioVentaManual > 0) {
    const ganancia = precioVentaManual - (precioVentaManual * comision) - costoBase - costoEnvio;
    const estado = ganancia >= 0 ? "GANANCIA" : "PÉRDIDA";
    texto += `\nSi vendes a ${formatoCOP(precioVentaManual)}: ${estado} de ${formatoCOP(ganancia)}`;
  }

  document.getElementById('resultadoVentas').textContent = texto;
}

['usarCosto','costoBaseManual','categoria','tipoPublicacion','envioGratis','peso','precioVentaManual'].forEach(id=>{
  document.getElementById(id).addEventListener('input', calcularVentas);
  document.getElementById(id).addEventListener('change', calcularVentas);
});
</script>

</body>
</html>
