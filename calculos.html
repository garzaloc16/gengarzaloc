<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cálculo de Compras y Ventas</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; padding:20px;}
  .container { max-width:600px; margin:auto; }
  h1, h2 { text-align:center; }
  label { display:block; margin:12px 0 6px; }
  input, select { width:100%; padding:8px; }
  .hidden { display:none; }
  button { margin-top:20px; width:100%; padding:10px; font-size:16px; cursor:pointer; }
  button:hover { background:#005bb5; color:white; }
  .result { margin-top:20px; background:#e8f5e9; padding:15px; border-radius:8px; }
</style>
</head>
<body>
<div class="container">
  <h1>Cálculo de Compras</h1>
  <label for="cantidad">Cantidad de productos:</label>
  <input type="number" id="cantidad" value="5">

  <label for="costo">Costo por compra (COP):</label>
  <input type="number" id="costo" value="15600">

  <button onclick="calcularCosto()">Calcular costo total</button>
  <div id="resultado" class="result"></div>

  <h2>Políticas MercadoLibre / Cálculo de Ventas</h2>

  <label for="categoria">Categoría</label>
  <select id="categoria">
    <option value="Electrónica">Electrónica</option>
    <option value="Hogar">Hogar</option>
    <option value="Ropa">Ropa</option>
  </select>

  <label for="tipo">Tipo de publicación</label>
  <select id="tipo">
    <option value="Clásica">Clasica</option>
    <option value="Premium">Premium</option>
  </select>

  <label for="envioGratis">¿Ofrecer envío gratis?</label>
  <select id="envioGratis">
    <option value="Si">Sí</option>
    <option value="No">No</option>
  </select>

  <label for="peso">Peso del producto (kg)</label>
  <input type="number" id="peso" value="1">

  <label for="manual">¿Ingresar precio de venta manual?</label>
  <select id="manual" onchange="toggleManualInput()">
    <option value="No">No</option>
    <option value="Si">Sí</option>
  </select>

  <div id="manualInput" class="hidden">
    <label for="precioManual">Precio de venta (COP):</label>
    <input type="number" id="precioManual">
  </div>

  <button onclick="calcularVentas()">Calcular ventas</button>
  <div id="resultadoVentas" class="result"></div>
</div>

<script>
function calcularCosto() {
  const cantidad = parseFloat(document.getElementById('cantidad').value);
  const costo = parseFloat(document.getElementById('costo').value);
  const costoTotal = cantidad * costo;
  const costoUnidad = costoTotal / cantidad;

  const div = document.getElementById('resultado');
  div.textContent = `Costo total: COP ${costoTotal.toFixed(2)} | Costo por unidad: COP ${costoUnidad.toFixed(2)}`;

  // Guardar costo por unidad en un atributo para usarlo después
  div.dataset.costoUnidad = costoUnidad;
}

function toggleManualInput() {
  const manual = document.getElementById('manual').value;
  document.getElementById('manualInput').classList.toggle('hidden', manual === "No");
}

function calcularVentas() {
  const resultadoDiv = document.getElementById('resultado');
  const costoUnidad = parseFloat(resultadoDiv.dataset.costoUnidad || 0);

  if (!costoUnidad) {
    alert("Primero calcula el costo en la sección superior.");
    return;
  }

  const categoria = document.getElementById('categoria').value;
  const tipo = document.getElementById('tipo').value;
  const envioGratis = document.getElementById('envioGratis').value;
  const peso = parseFloat(document.getElementById('peso').value);
  const manual = document.getElementById('manual').value;

  // Comisiones
  let comisionClasica = 0.13;
  let comisionPremium = 0.16;

  // Costo de envío simple (puedes ajustar por rangos de peso)
  let costoEnvio = 0;
  if (envioGratis === "Si") {
    if (peso <= 1) costoEnvio = 8000;
    else if (peso <= 5) costoEnvio = 12000;
    else costoEnvio = 20000;
  }

  // Precio sugerido
  let precioVenta = manual === "Si" ? 
      parseFloat(document.getElementById('precioManual').value) :
      costoUnidad * 1.5;

  // Calcular ganancias
  const ventasDiv = document.getElementById('resultadoVentas');

  const calcGanancia = (comision) => {
    const comisionValor = precioVenta * comision;
    const neto = precioVenta - comisionValor - costoEnvio - costoUnidad;
    const porcentaje = (neto / costoUnidad) * 100;
    return { neto, porcentaje, comisionValor };
  };

  const clasica = calcGanancia(comisionClasica);
  const premium = calcGanancia(comisionPremium);

  ventasDiv.innerHTML = `
    Precio sugerido (50% margen): COP ${precioVenta.toFixed(2)}<br><br>
    Clasica: Comisión 13.0%, Ganancia neta COP ${clasica.neto.toFixed(2)}, % ganancia ${clasica.porcentaje.toFixed(1)}%<br>
    Premium: Comisión 16.0%, Ganancia neta COP ${premium.neto.toFixed(2)}, % ganancia ${premium.porcentaje.toFixed(1)}%
  `;
}
</script>
</body>
</html>
